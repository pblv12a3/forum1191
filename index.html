<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ForumsR</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" type="image/png" href="favcon.png">
</head>
<body>

<header class="topbar">
  <a class="brandLink" href="index.html">
    <img class="brandLogo" src="favcon.png" alt="ForumsR">
    <span class="brandText">ForumsR</span>
  </a>

  <div class="topRight">
    <span id="userLabel" class="muted" style="color:#fff"></span>
    <button id="btnOpenSettings" class="hidden">Settings</button>
    <button id="btnLogout" class="hidden">Logout</button>
  </div>
</header>

<main class="container">

  <div id="loadingBanner" class="loadingBanner">
    Loading ForumsRâ€¦
  </div>

  <!-- SETTINGS -->
  <section id="settingsCard" class="hidden">
    <h2>Settings</h2>
    <div class="row">
      <button id="btnCloseSettings">Close</button>
    </div>
    <input id="settingsUsername" placeholder="New username (letters/numbers/._-)" />
    <input id="settingsPhotoUrl" placeholder="New profile picture URL (optional https://...)" />
    <button id="btnSaveSettings">Save</button>
    <div id="settingsMsg" class="muted"></div>
  </section>

  <!-- PROFILE (shown if user has no profile yet) -->
  <section id="profileCard">
    <h2>Create profile</h2>
    <input id="profileUsername" placeholder="Username (letters/numbers/._-)" />
    <input id="profilePhotoUrl" placeholder="Profile picture URL (optional https://...)" />
    <button id="btnSaveProfile">Save profile</button>
    <div id="profileMsg" class="muted"></div>
  </section>

  <!-- POST -->
  <section id="composerCard">
    <h2>New post</h2>
    <input id="postTitle" placeholder="Title" />
    <textarea id="postBody" placeholder="Text"></textarea>
    <input id="imageUrl" placeholder="Image URL (optional https://...)" />
    <input id="videoUrl" placeholder="Video URL (optional https://...)" />
    <button id="btnPublish">Publish</button>
    <div id="publishMsg" class="muted"></div>
  </section>

  <!-- FEED -->
  <section id="feed">
    <h2>Posts</h2>
    <div id="posts"></div>
  </section>

</main>

<!-- Reply dialog -->
<dialog id="replyDialog">
  <form method="dialog" class="dialogBox">
    <h3 id="replyToTitle">Reply</h3>
    <textarea id="replyText" placeholder="Write your reply..."></textarea>
    <div class="row">
      <button id="btnSendReply" type="button">Send reply</button>
      <button type="submit">Close</button>
    </div>
    <div id="replyMsg" class="muted"></div>
  </form>
</dialog>

<script type="module">
  // Visible badge proves JS is running
  document.body.insertAdjacentHTML(
    "beforeend",
    '<div style="position:fixed;bottom:8px;right:8px;background:#000;color:#0f0;padding:6px;font:12px monospace;z-index:99999">HOME JS LOADED</div>'
  );

  // Only redirect to uhoh on real crashes (ignore extensions)
  const shouldRedirect = (reason) => {
    const m = String(reason?.code || reason?.message || reason || "");
    if (m.includes("chrome-extension://")) return false;
    return true;
  };
  window.addEventListener("error", (e) => { if (shouldRedirect(e?.error || e?.message)) location.href = "uhoh.html"; });
  window.addEventListener("unhandledrejection", (e) => { if (shouldRedirect(e?.reason)) location.href = "uhoh.html"; });

  import "./app_v3.js?v=7";
</script>

</body>
</html>


